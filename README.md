# README (JPN)

# 岡山県高梁市巨瀬町の水田消失から見る生物多様性損失リスク

## Abstruct
生物多様性分野及び衛星データ活用の技術素養取得のための個人プロジェクト。\
岡山県高梁市巨瀬町の水田の減少の様子を1976年から2021年の期間で地図化。\
また、水田損失リスク予測マップをランダムフォレストでの学習を用いて作成し、NDVI画像を用いて評価を行った。

## Motivation
岡山県高梁市巨瀬町は私talltomuraの祖父が住んでいた土地であり、自然豊かな土地であった。
幼少の頃は、休みの度に巨瀬町を訪れ、自然の中で過ごしていた。

当時、巨瀬町は田畑が多い町であり、人々の農村での生活と隣り合って様々な動植物が生息していた。
水田が多い関係もあり、カエルやドジョウ、ヤゴやゲンゴロウなど、両生類をはじめ水生昆虫が多く生息していた。
しかし、子供時代から大人になるにつれ、巨瀬町に訪れる度に小さな生き物の数が減っていることに気づいた。
夜になると、大量のカエルが窓に張り付いていたのだが、気づくとそのような光景を見ることはなくなった。
水田の隣を流れる水路からも生き物は姿を消し、そもそも農村の風景が巨瀬町、そして高梁市から消えているように感じた。

日本において、里山の暮らしによって維持される、農村風景は生物多様性を構成する重要な要素になっており、
水田や畑が耕作放棄地へと変化することにより生物多様性損失のリスクが発生する。
(https://www.nies.go.jp/whatsnew/20170630/20170630.html)。 \

私がこれまで「なんとなく」で感じていた生物の消失はおそらく水田の消失が原因である。
衛星データ活用や地理空間データの活用の学習として、高梁市の水田の消失について分析を行った。

## Dataset
分析において以下のデータセットを用いた。

- **地理空間ファイル**
    - 国土数値情報ダウンロードサイトより
        - https://nlftp.mlit.go.jp/ksj/gml/datalist/KsjTmplt-L03-b-2021.html
        - 1976年・1987年・1991年・1997年・2006年・2009年・2014年・2016年・2021年の岡山県の土地利用マップ
    - 岡山県高梁市の境界データ(2022年)
        - https://www.e-stat.go.jp/gis/statmap-search?page=1&type=2&aggregateUnitForBoundary=A&toukeiCode=00200521&toukeiYear=2020&serveyId=A002005212020&prefCode=33&coordsys=1&format=shape&datum=2000
    - 河川データ
        - https://nlftp.mlit.go.jp/ksj/gml/datalist/KsjTmplt-W05.html
        - 平成20年度岡山県世界測地系

- **衛星データ**
    - Google Earth EngineのAPIをNotebookに接続して使用。
    - NDVI(Normalized Difference Vegetation Index)画像の取得のためにSentinel衛星の画像データを使用した。

## Works

本プロジェクトでは以下のプロセスで分析を行った。

1. **土地利用データの可視化 (QGIS / Python)**
    - 国土数値情報のデータを読み込み、QGISおよびPython (GeoPandas) で可視化。
    - 年代によって異なる土地利用コードを統一基準（水田、畑、森林、開発地など）に再定義し、経年変化を追跡可能にした。
2. **インタラクティブマップの作成**
    - ライブラリ `Folium` を使用し、1976年から2021年までの土地利用変化をWebブラウザ上で切り替え表示できるマップを作成。
    - 河川データをオーバーレイし、水辺環境との位置関係を確認。
3. **土地利用森林化（水田消失）リスクの予測**
    - **前処理**: 各メッシュの過去の土地利用履歴や周辺環境(距離)を特徴量としてデータセットを作成。
    - **学習**: 機械学習モデル（Random Forest等）を用いて、水田が森林や耕作放棄地に変化するリスクを学習。
    - **予測**: 将来的に水田が消失する可能性が高いエリアを確率マップとして出力。
4. **衛星画像を用いたWチェック**
    - Sentinel-2衛星画像からNDVI（正規化植生指数）を算出。
    - 2025年時点の植生データとモデルの予測結果を比較し、耕作放棄されている可能性が高い水田（高NDVI値の場所など）の位置推定の妥当性を検証。

## Result
* **土地利用の変遷**: 1976年当時は広範囲に存在した水田が、2021年にかけて徐々に森林や荒地、一部は開発地へと転換している様子が可視化された。
* **リスクマップの生成**: 機械学習モデルにより、巨瀬町内の「今後消失するリスクが高い水田」をヒートマップ形式で特定することに成功した。
* **モデル精度と検証**: NDVI画像との重ね合わせにより、モデルが「消失リスク高」と判定したエリアは、実際の衛星画像でも植生の繁茂（耕作放棄の兆候）が見られる傾向を確認した。

## Environment
本分析は以下の環境・ライブラリを使用。

* **Python 3.x**
* **GeoPandas**: 地理空間データの操作
* **Folium**: 地図データの可視化
* **Pandas / NumPy**: データフレーム操作・数値計算
* **Matplotlib / Seaborn**: グラフ描画
* **Rasterio**: ラスターデータ（衛星画像）の処理
* **Scikit-learn**: 機械学習モデルの構築
* **Google Earth Engine API**: 衛星データの取得

## Usage
本プロジェクトはDocker環境上で作成したコンテナ環境で動作させている。\
.devcontainer内にDockerfileをはじめVSCODE上でJupyter Notebookを動作させるjsonファイルを格納している。

Docker環境立ち上げ後、work/analysis.ipynbでコードの実行が可能である。
※ただし、Earth Engine APIとの接続が必要なパートがあるため、GEEのアカウント作成が必要である。


## Notes

* **Future Work (Plan):**
    - 水田に生息する生物のSDM (Species Distribution Model) と組み合わせた分析
    - 衛星の画像データをさらに組み合わせた水田損失リスクマップの作成
